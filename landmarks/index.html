<!DOCTYPE html>
<html>
    <head>
        <title>Local Landmarks</title>
        <link href="style.css" rel="stylesheet">
        <meta name="viewport" content="initial-scale=1.0">
        <meta charset="utf-8">
    </head>
    <body onload="initMap()">
        <div id="map"></div>
        <script>
                var map;
                var myLat;
                var myLng;
                var myLoc;
                var request;

        function getLocation(position) {
               if (navigator.geolocation) {
                       navigator.geolocation.getCurrentPosition(function(position) {
                               myLat = position.coords.latitude;
                               myLng = position.coords.longitude;
                       });
                }       
                myLoc = new google.maps.LatLng(myLat, myLng);
        }

        function initMap() {
                 getLocation();
                 map = new google.maps.Map(document.getElementById('map'), {
                           center: myLoc,
                           zoom: 15
                 });
                 getPeople();
        }

        function getPeople() {
                request = new XMLHttpRequest();
                var url = "https://defense-in-derpth.herokuapp.com/sendLocation"
                var params = "login=JIMMIE_HULL&lat=" + myLat + "&lng=" + myLng;
                request.open("POST", url, true);
                request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

                request.onreadystatechange = function() {
                        if (request.readyState == 4 && request.status == 200) {
                                var response = JSON.parse(request.responseText);
                                showPeople(response.people);
                                showLandmarks(response.landmarks)
                        }
                }
                request.send(params);
        }

        function showPeople(people) {
                for (var i = 0; i < people.length; i++) {
                        var pos = new google.maps.LatLng(people[i].lat, people[i].lng);
                        new google.maps.Marker({
                                position: pos,
                                map: map
                        });
                }        
        }

        function showLandmarks(landmarks) {
                        
        }

    </script>
    <script src="https://maps.googleapis.com/maps/api/js?callback=initMap"
    async defer></script>
  </body>
</html>
